<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@0.4.1/dist/jsQR.min.js"></script>
  </head>
  <body>
    <video id="video" width="640" height="480" autoplay></video>
    <canvas id="canvas" width="640" height="480"></canvas>

    <script>
      const video = document.getElementById("video");
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");

      navigator.mediaDevices
        .getUserMedia({ video: { facingMode: "environment" } })
        .then((stream) => {
          video.srcObject = stream;
        });

      video.addEventListener("play", () => {
        const { videoWidth: width, videoHeight: height } = video;
        canvas.width = width;
        canvas.height = height;

        setInterval(() => {
          ctx.drawImage(video, 0, 0, width, height);
          const imageData = ctx.getImageData(0, 0, width, height);
          const code = jsQR(imageData.data, imageData.width, imageData.height);

          if (code) {
            console.log(code.data);
          }
        }, 16);
      });
    </script>
  </body>
</html>
